# 代码规范

## 1. 通用规范

### 1.1 文件编码
- 所有文件采用 UTF-8 编码
- 文件末尾添加换行符
- 移除行尾多余空格

### 1.2 命名规范
- **包名**：小写字母，使用点分隔，如 `com.example.backend`
- **类名**：大驼峰命名法，如 `UserService`
- **方法名**：小驼峰命名法，如 `getUserById`
- **变量名**：小驼峰命名法，如 `userName`
- **常量名**：全大写，下划线分隔，如 `MAX_PAGE_SIZE`
- **接口名**：大驼峰命名法，前缀 `I` 可选，如 `UserRepository` 或 `IUserRepository`
- **组件名**：大驼峰命名法，如 `HeaderComponent`

### 1.3 注释规范
- 使用清晰、简洁的注释
- 类和方法添加 Javadoc/KDoc 注释
- 复杂逻辑添加单行或多行注释
- 注释语言与代码语言一致

## 2. 前端代码规范

### 2.1 Vue 组件规范
- 组件文件使用大驼峰命名法，如 `UserList.vue`
- 组件选项顺序：
  ```vue
  <template>
    <!-- 模板内容 -->
  </template>
  
  <script setup lang="ts">
  // 导入语句
  import { ref, computed } from 'vue'
  
  // Props 定义
  defineProps<{
    userId: string
  }>()
  
  // Emits 定义
  const emit = defineEmits<{
    (e: 'update', value: string): void
  }>()
  
  // 响应式数据
  const userName = ref('')
  
  // 计算属性
  const fullName = computed(() => `Mr. ${userName.value}`)
  
  // 方法
  const handleClick = () => {
    emit('update', userName.value)
  }
  </script>
  
  <style scoped>
  /* 样式 */
  </style>
  ```

### 2.2 TypeScript 规范
- 为所有变量、函数、组件添加类型定义
- 避免使用 `any` 类型，除非必要
- 使用接口定义对象类型
- 使用枚举定义常量集合

### 2.3 ESLint 与 Prettier
- 项目使用 ESLint 进行代码质量检查
- 使用 Prettier 进行代码格式化
- 开发过程中运行 `npm run lint` 检查代码
- 运行 `npm run format` 自动格式化代码

### 2.4 目录结构规范
- 按功能模块组织代码
- 组件、工具、API 等分类存放
- 使用清晰的目录命名

## 3. 后端代码规范

### 3.1 Java 代码规范
- 遵循 Java 语言规范
- 使用 Lombok 简化代码
- 方法长度不宜过长，建议不超过 50 行
- 类的职责单一，遵循单一职责原则

### 3.2 Spring Boot 规范
- 使用注解简化配置
- 控制器层使用 `@RestController` 注解
- 服务层使用 `@Service` 注解
- 数据访问层使用 `@Mapper` 或 `@Repository` 注解
- 配置类使用 `@Configuration` 注解

### 3.3 MyBatis Plus 规范
- 实体类使用 `@TableName`、`@TableId` 等注解
- Mapper 接口继承 `BaseMapper`
- Service 类继承 `ServiceImpl` 或实现自定义接口
- 使用 Lambda 表达式构建查询条件

### 3.4 异常处理规范
- 自定义业务异常类
- 全局异常处理器统一处理异常
- 异常信息清晰、准确

### 3.5 日志规范
- 使用 SLF4J + Logback 进行日志记录
- 日志级别合理使用：DEBUG、INFO、WARN、ERROR
- 日志内容包含必要信息，如操作人、操作时间、操作内容等

## 4. 数据库规范

### 4.1 表设计规范
- 表名使用小写字母，下划线分隔，如 `sys_user`
- 主键使用 `id`，类型为 `BIGINT`
- 逻辑删除字段使用 `is_deleted`，类型为 `TINYINT`
- 创建时间和更新时间字段：`create_time` 和 `update_time`，类型为 `DATETIME`
- 字段名使用小写字母，下划线分隔，如 `user_name`

### 4.2 SQL 规范
- 使用 MyBatis Plus 提供的 CRUD 方法
- 复杂查询使用 XML 映射文件
- SQL 语句格式清晰，适当换行

## 5. Git 规范

### 5.1 分支管理
- `main`：主分支，用于发布生产版本
- `develop`：开发分支，用于集成开发
- `feature/xxx`：功能分支，用于开发新功能
- `bugfix/xxx`： bug 修复分支
- `hotfix/xxx`：紧急修复分支

### 5.2 提交规范
- 提交信息清晰、简洁
- 提交信息格式：`类型: 描述`，如 `feat: 添加用户管理功能`
- 常见类型：
  - `feat`：新功能
  - `fix`：修复 bug
  - `docs`：文档更新
  - `style`：代码格式调整
  - `refactor`：代码重构
  - `test`：测试代码更新
  - `chore`：构建工具或依赖更新

### 5.3 Pull Request 规范
- PR 标题清晰，描述详细
- 关联相关 Issue
- 通过所有 CI 检查
- 代码审核通过后合并

## 6. IDE 配置

### 6.1 编辑器配置
- 所有开发者使用相同的 `.editorconfig` 配置
- IDEA 开发者使用统一的代码格式化配置
- VS Code 开发者安装推荐的扩展

### 6.2 开发工具
- 推荐使用 IntelliJ IDEA 开发后端
- 推荐使用 VS Code 开发前端
- 安装必要的插件，如 ESLint、Prettier、Vue Language Features 等

## 7. 代码审查规范

### 7.1 审查内容
- 代码质量：可读性、可维护性、性能
- 代码规范：遵循项目规范
- 功能实现：符合需求
- 安全性：避免安全漏洞
- 测试覆盖：适当的测试用例

### 7.2 审查流程
- 代码提交后发起 PR
- 至少一名其他开发者审查
- 审查意见及时回复
- 审查通过后合并代码

## 8. 性能优化规范

### 8.1 前端性能优化
- 组件懒加载
- 路由懒加载
- 图片优化
- 减少 HTTP 请求
- 使用缓存

### 8.2 后端性能优化
- 数据库索引优化
- 避免 N+1 查询问题
- 使用缓存（如 Redis）
- 异步处理耗时操作
- 合理设置连接池大小

## 9. 安全规范

### 9.1 前端安全
- 防止 XSS 攻击
- 防止 CSRF 攻击
- 敏感数据加密
- 安全的 API 调用

### 9.2 后端安全
- 身份认证和授权
- 输入验证
- SQL 注入防护
- 跨域资源共享（CORS）配置
- 安全的密码存储（使用 BCrypt 等）

## 10. 测试规范

### 10.1 前端测试
- 单元测试：使用 Vitest 测试组件和工具函数
- E2E 测试：使用 Cypress 测试完整流程
- 测试覆盖率目标：80% 以上

### 10.2 后端测试
- 单元测试：使用 JUnit 5 测试服务层和工具类
- 集成测试：测试数据库操作和 API
- 接口测试：使用 Postman 或 Swagger 测试 API
- 测试覆盖率目标：70% 以上

## 11. 部署规范

### 11.1 环境管理
- 开发环境、测试环境、生产环境分离
- 配置文件根据环境区分
- 使用环境变量配置敏感信息

### 11.2 CI/CD 流程
- 代码提交触发 CI 构建
- 自动运行测试和代码检查
- 构建成功后部署到测试环境
- 手动或自动部署到生产环境

## 12. 文档规范

### 12.1 API 文档
- 使用 Swagger 自动生成 API 文档
- API 文档包含所有接口信息
- 定期更新 API 文档

### 12.2 项目文档
- 包含项目介绍、技术栈、架构设计等
- 开发文档清晰、完整
- 部署文档详细、可操作

### 12.3 变更文档
- 记录项目变更历史
- 包含版本号、变更内容、变更人、变更时间等

## 13. 版本管理规范

### 13.1 版本号格式
- 使用语义化版本号：`MAJOR.MINOR.PATCH`
- `MAJOR`：不兼容的 API 变更
- `MINOR`：向下兼容的新功能
- `PATCH`：向下兼容的问题修复

### 13.2 发布流程
- 编写发布说明
- 测试发布版本
- 部署到生产环境
- 记录发布信息

## 14. 团队协作规范

### 14.1 沟通规范
- 定期召开团队会议
- 使用统一的沟通工具
- 及时反馈问题和进度

### 14.2 任务管理
- 使用项目管理工具（如 Jira、Trello）
- 任务分解清晰
- 合理分配任务
- 定期更新任务进度

### 14.3 知识共享
- 定期分享技术知识
- 文档化重要决策
- 代码审查时分享经验

## 15. 附则

- 本规范适用于项目所有开发者
- 规范根据实际情况定期更新
- 违反规范的代码需要修正
- 规范解释权归项目团队所有